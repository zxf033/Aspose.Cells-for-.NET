+++
title = "Reading and Writing Query Table of Worksheet" 
description = "" 
weight = 20537 
+++

Aspose.Cells for .NET : Reading and Writing Query Table of Worksheet  

# Aspose.Cells for .NET : Reading and Writing Query Table of Worksheet


Aspose.Cells provides `Worksheet.QueryTables` collection which returns the object of type `QueryTable` by index. It has the following two properties

*   `QueryTable.AdjustColumnWidth`
*   `QueryTable.PreserveFormatting`

These are both boolean values. You can view them in Microsoft Excel via `Data > Connections > Properties`.

## Reading and Writing Query Table of Worksheet

The following sample code reads the first `QueryTable` of the first worksheet and then prints both of the `QueryTable` properties. Then it sets the `QueryTable.PreserveFormatting` to true.

You can download the source Excel file used in this code and the output Excel file generated by the code from the following links.

*   [Source Excel File](https://docs2.aspose.com/cells/net/attachments/5023523/5115533.xlsx)
*   [Output Excel File](https://docs2.aspose.com/cells/net/attachments/5023523/5115537.xlsx)

### Console Output

Here is the console output of the above sample code

{{< code lang="cs" >}}
Adjust Column Width: True
Preserve Formatting: False
{{< /code >}}

## Retrieve query table result rangeÂ 

Aspose.Cells provides option to read the address i.e. result range of cells for a query table. Following code demonstrates this feature by reading the address of result range for a query table. Sample file can be downloaded [here](https://docs2.aspose.com/cells/net/attachments/5023523/72417290.xlsx).

## Attachments:

![](https://docs2.aspose.com/cells/net/images/icons/bullet_blue.gif) [before-setting-query-table.png](https://docs2.aspose.com/cells/net/attachments/5023523/5115536.png) (image/png)  
![](https://docs2.aspose.com/cells/net/images/icons/bullet_blue.gif) [Output.xlsx](https://docs2.aspose.com/cells/net/attachments/5023523/5115537.xlsx) (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)  
![](https://docs2.aspose.com/cells/net/images/icons/bullet_blue.gif) [Sample.xlsx](https://docs2.aspose.com/cells/net/attachments/5023523/5115533.xlsx) (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)  
![](https://docs2.aspose.com/cells/net/images/icons/bullet_blue.gif) [after-setting-query-table.png](https://docs2.aspose.com/cells/net/attachments/5023523/5115532.png) (image/png)  
![](https://docs2.aspose.com/cells/net/images/icons/bullet_blue.gif) [Query TXT.xlsx](https://docs2.aspose.com/cells/net/attachments/5023523/72417290.xlsx) (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)  

